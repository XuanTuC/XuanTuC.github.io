<!DOCTYPE html>
<html lang="zh-CN">
  <head><!-- hexo injector head_begin start -->
<link rel="stylesheet" href="/css/bilicard.css">
<!-- hexo injector head_begin end -->
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="xuan tu">







<title>利用MindSpore实现VI-LayoutXLM模型 | 曲径通幽处.</title>



    <link rel="icon" href="/favicon.ico">



<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&family=Roboto+Mono&display=swap');
</style>



    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    




    <!-- scripts list from _config.yml -->
    
    <script src="/js/frame.js"></script>
    










  <meta name="generator" content="Hexo 6.3.0"></head>
  <body>
    <div class="mask-border">
    </div>

    <div class="wrapper">

      <div class="header">
  <div class="flex-container">
    <div class="header-inner">
      <div class="site-brand-container">
        <a href="/">
          
            ヾ(^_^) back Home.!!
          
        </a>
      </div>
      <div id="menu-btn" class="menu-btn" onclick="toggleMenu()">
        Menu
      </div>
      <nav class="site-nav">
        <ul class="menu-list">
          
            
              <li class="menu-item">
                <a href="/">主页</a>
              </li> 
                   
          
            
              <li class="menu-item">
                <a href="/archives/">文章</a>
              </li> 
                   
          
            
              <li class="menu-item">
                <a target="_blank" rel="noopener" href="https://drive.google.com/drive/folders/1a-OiD9e0tEgNmWDoR0RGkhBtp-v8TQq8?usp=drive_link">图书馆(M)</a>
              </li> 
                   
          
          
        </ul>
      </nav>
    </div>
  </div>
</div>


      <div class="main">
        <div class="flex-container">
          <article id="post">

  
    <div class="post-head">
    <div class="post-info">
        <div class="tag-list">
            
        </div>
        <div class="post-title">
            
            
                利用MindSpore实现VI-LayoutXLM模型
            
            
        </div>
        <span class="post-date">
            7月 13, 2023
        </span>
    </div>
    <div class="post-img">
        
            <div class="h-line-primary"></div>
              
    </div>
</div>
    <div class="post-content">
    <p>本文参考地址：<a target="_blank" rel="noopener" href="https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.6/doc/doc_ch/quickstart.md">https://github.com/PaddlePaddle/PaddleOCR/blob/release/2.6/doc/doc_ch/quickstart.md</a></p>
<p>前置mindspore安装参考我的acfun教程：<a target="_blank" rel="noopener" href="https://www.acfun.cn/a/ac41786362">https://www.acfun.cn/a/ac41786362</a></p>
<p>清华镜像：（如果pip出问题就在后面加这个）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<p>具体步骤：</p>
<p>打开pycharm的控制台</p>
<h2 id="安装PaddlePaddle（cpu平台）"><a href="#安装PaddlePaddle（cpu平台）" class="headerlink" title="安装PaddlePaddle（cpu平台）"></a>安装PaddlePaddle（cpu平台）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install paddlepaddle -i https://mirror.baidu.com/pypi/simple</span><br></pre></td></tr></table></figure>



<h2 id="安装PaddleOCR-whl包"><a href="#安装PaddleOCR-whl包" class="headerlink" title="安装PaddleOCR whl包"></a><strong>安装PaddleOCR whl包</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install &quot;paddleocr&gt;=2.0.1&quot; -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>



<p>PaddleOCR提供了一系列测试图片，点击<a target="_blank" rel="noopener" href="https://paddleocr.bj.bcebos.com/dygraph_v2.1/ppocr_img.zip">这里</a>下载并解压，然后在终端中切换到相应目录（&#x2F;path&#x2F;to&#x2F;ppocr_img填你实际的目录）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /path/to/ppocr_img</span><br></pre></td></tr></table></figure>



<p><strong>检测+方向分类器+识别全流程：<code>--use_angle_cls true</code>设置使用方向分类器识别180度旋转文字，<code>--use_gpu false</code>设置不使用GPU</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">paddleocr --image_dir ./imgs/11.jpg --use_angle_cls true --use_gpu false</span><br></pre></td></tr></table></figure>



<p><strong>提示没有paddle包：</strong></p>
<p><strong>安装：</strong></p>
<p><code>python -m pip install paddlepaddle==2.4.2 -i https://pypi.tuna.tsinghua.edu.cn/simple</code>            </p>
<p>参见：<a target="_blank" rel="noopener" href="https://www.paddlepaddle.org.cn/%E3%80%81">https://www.paddlepaddle.org.cn/、</a></p>
<hr>
<p><strong>再次出现问题：ImportError: numpy.core.multiarray failed to import</strong></p>
<p>在终端输入：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line"></span><br><span class="line">import numpy</span><br><span class="line"></span><br><span class="line">print(numpy.__path__)</span><br><span class="line"></span><br><span class="line">exit()</span><br></pre></td></tr></table></figure>

<p>删除显示的路径</p>
<p><strong>重新安装numpy</strong></p>
<h2 id="调试程序：检测-方向分类器-识别全流程"><a href="#调试程序：检测-方向分类器-识别全流程" class="headerlink" title="调试程序：检测+方向分类器+识别全流程"></a><strong>调试程序：</strong>检测+方向分类器+识别全流程</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> paddleocr <span class="keyword">import</span> PaddleOCR, draw_ocr</span><br><span class="line"></span><br><span class="line">ocr = PaddleOCR(use_angle_cls=<span class="literal">True</span>, lang=<span class="string">&quot;ch&quot;</span>)</span><br><span class="line">img_path = <span class="string">r&quot;C:\Users\34476\Desktop\赛题四所需\ppocr_img\ppocr_img\imgs\11.jpg&quot;</span></span><br><span class="line">result = ocr.ocr(img_path, cls=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)):</span><br><span class="line">    res = result[idx]</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> res:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">result = result[<span class="number">0</span>]</span><br><span class="line">image = Image.<span class="built_in">open</span>(img_path).convert(<span class="string">&#x27;RGB&#x27;</span>)</span><br><span class="line">boxes = [line[<span class="number">0</span>] <span class="keyword">for</span> line <span class="keyword">in</span> result]</span><br><span class="line">txts = [line[<span class="number">1</span>][<span class="number">0</span>] <span class="keyword">for</span> line <span class="keyword">in</span> result]</span><br><span class="line">scores = [line[<span class="number">1</span>][<span class="number">1</span>] <span class="keyword">for</span> line <span class="keyword">in</span> result]</span><br><span class="line">font_path = <span class="string">r&quot;C:\Users\34476\Desktop\赛题四所需\ppocr_img\ppocr_img\fonts\simfang.ttf&quot;</span></span><br><span class="line">im_show = draw_ocr(image, boxes, txts, scores, font_path=font_path)</span><br><span class="line">im_show = Image.fromarray(im_show)</span><br><span class="line">im_show.save(<span class="string">&#x27;result.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\34476\AppData\Roaming\Typora\typora-user-images\image-20230713222705345.png" alt="image-20230713222705345"></p>
<p>显示的结果：</p>
<p><img src="C:\Users\34476\AppData\Roaming\Typora\typora-user-images\image-20230713223057505.png" alt="image-20230713223057505"></p>

</div> 

<script>
    window.onload = detectors();
</script>
    <div class="post-footer">
    <div class="h-line-primary"></div>
    <nav class="post-nav">
        <div class="prev-item">
           
                <div class="icon arrow-left"></div>
                <div class="post-link">
                    <a href="/2023/07/16/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E6%98%87%E8%85%BEAI%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B/">Prev</a>
                </div>
            
        </div>
        <div class="next-item">
            
                <div class="icon arrow-right"></div>
                <div class="post-link">
                  <a href="/2023/07/08/%E5%AE%89%E8%A3%85mind/">Next</a>  
                </div>  
            
        </div>
    </nav>
</div>

    
      <div class="post-comment">

     

     


    
       <!--PC版-->
        <div id="SOHUCS" ></div>
        <script charset="utf-8" type="text/javascript" src="https://cy-cdn.kuaizhan.com/upload/changyan.js" ></script>
        <script type="text/javascript">
        window.changyan.api.config({
            appid: 'cywJvGKKO',
            conf: 'prod_dfd0ec91693832034dcc62943592b045'
        });
        </script>   
     

</div>
     
  
</article>
        </div>
      </div>
      
      <div class="footer">
    <div class="flex-container">
        <div class="footer-text">
            
                
                <br>
            
            
            
                Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & <a target="_blank" rel="noopener" href="https://github.com/zoeingwingkei/frame/">Frame</a>
                
        </div>
    </div>
</div>

    </div>

    
    

  </body>
</html>
